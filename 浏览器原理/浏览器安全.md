# 4.浏览器安全
## XSS

### 概念
+ `XSS(跨站脚本攻击)`是指攻击者在返回的 HTML 中嵌入 `javascript`脚本，从而拿到用户的信息并进行操作。
+ `XSS` 分为三种：`存储型`，`反射型`和 `文档形`


### 存储型
+ `存储型`的 `XSS` 将脚本存储到了服务端的数据库，然后在客户端执行这些脚本，从而达到攻击的效果。
+ 常见的场景就是评论区提交一段脚本代码，如果前后端没有做好转义，存储到数据库后，在客户端渲染时直接执行；


### 反射型
+ 反射形 `XSS` 攻击指的是恶意脚本作为请求`URL的参数`；浏览器解析后作为脚本执行
+ 之所以叫它`反射型`, 是因为恶意脚本是通过作为`网络请求的参数`出现在 url 中，经过服务器解析响应，拼接在 HTML 中传回给客户端，然后浏览器解析执行恶意脚本。
+ `和存储`型不一样的是，服务器并不会存储这些恶意脚本。


### 文档型
+ `文档形`的 XSS 攻击其实也是恶意脚本被作为`请求URL的参数`；浏览器解析后作为脚本执行，和反射形的区别在于：由前端JS取出 URL 中的恶意代码并执行


### 防范措施
+ 最普遍的做法就是`转义`和`过滤`：对引号，尖括号，斜杠进行转义，让代码在`html`解析的过程中无法执行；过滤就是把 `script`标签给删除；
+ 利用 `HttpOnly`：`cookie` 设置 `httponly` 后，会禁止 `javascript` 脚本来访问 `cookie`，这样，XSS攻击之后也无法获取用户的`cookie`；
+ 其次就是使用 `CSP`：`CSP` 也就是浏览器内容安全策略；只允许加载指定域的脚本及样式；


## CSRF

### 概念
+ `CSRF`（跨站请求伪造） 就是黑客诱导用户跳转恶意网站，然乎利用用户的登录态发起恶意请求；
+ 原理就是`http`请求会自动携带 `Cookie`，而且是 `HTTP` 目标请求域名的 `Cookie`;


### 防范措施
+ `SameSite Cookies`: 该属性表示 `Cookie` 不随着跨域请求发送，可以很大程度减少 `CSRF` 的攻击；它有`Strict`（浏览器将只发送相同站点（完全一致）请求的 `Cookie`）、`Lax`（第三方`get`方法可以携带`Cookie`） 和 `None` （任何情况下都会发送 `Cookie`）三个值。
+ `Origin` 和 `Referer`：验证`Referer`是否是从第三方网站发出来的，阻止第三方网站请求接口，但是这两者可以通过`ajax`自定义请求头的方式被伪造；
+ `CSRF Token`：客户端向服务端请求`token`，然后在所有的请求中带上；

### Chrome80 版本的 CSRF 例子
讲到 `CSRF` 的 `cookie` ，不得不提一下 `Chrome 80` 版本的的一个默认设置；`Chrome 80` 版本将 `SameSite` 的值设置为了 `Lax`；这导致之前公司有一些业务产生了跨域；


## XSS和CSRF的区别
+ 两者的原理区别：`CSRF` 是利用 `网站A` 本身的漏洞，去请求 `网站A` 的 `api`。而 `XSS` 是向`网站A` 注入 `JS代码`，然后执行 `JS` 里的代码，篡改`网站A`的内容。
+ `CSRF`仅仅是利用了`http`携带`cookie`的特性进行攻击的，但是无法得到被攻击站点的`cookie`。这个和`XSS`不同，XSS一般是直接通过拿到`Cookie`等信息进行攻击的
 

## SQL注入
## 点击劫持